一个C版本，未完成。